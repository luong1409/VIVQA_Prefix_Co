[32m2023-05-04 21:22:25.178[39m | [34m[1mDEBUG   [39m[22m | [36m__main__[39m:[36mmain[39m:[36m104[39m - [34m[1mjob dir: /home/vqa_mplug
[32m2023-05-04 21:22:25.179[39m | [34m[1mDEBUG   [39m[22m | [36m__main__[39m:[36mmain[39m:[36m105[39m - [34m[1mNamespace(accum_iter=1,
[34m[1mbase_lr=0.0005,
[34m[1mbatch_size=16,
[34m[1mcheckpoint_path='',
[34m[1mdata_root='',
[34m[1mdataset_names=['custom'],
[34m[1mdevice='cuda',
[34m[1mepochs=10,
[34m[1mlr=None,
[34m[1mmodel='',
[34m[1mnum_workers=4,
[34m[1moutput_dir='./result',
[34m[1mpin_memory=True,
[34m[1mprint_every=1,
[34m[1mrandom_prefix_len=False,
[34m[1mresume=None,
[34m[1mrun_id=None,
[34m[1mrun_name='',
[34m[1msave_every=1,
[34m[1mseed=0,
[34m[1mstart_epoch=0,
[34m[1mwarmup_steps=3000)
 50%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç                                                                           | 20777/41886 [00:00<00:00, 207577.19it/s]
Using cache
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 41886/41886 [00:00<00:00, 214401.88it/s]
100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 10472/10472 [00:00<00:00, 225757.75it/s]
Downloading (‚Ä¶)lve/main/config.json: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 570/570 [00:00<00:00, 63.1kB/s]
[32m2023-05-04 21:22:41.525[39m | [31m[1mERROR   [39m[22m | [36m__main__[39m:[36m<module>[39m:[36m301[39m - [31m[1mSomething wrong
[33m[1mTraceback (most recent call last):
  File "/opt/conda/envs/coca/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
                ‚îî ModuleSpec(name='__main__', loader=<_frozen_importlib_external.SourceFileLoader object at 0x7f63e919cd10>, origin='/root/.vsc...
  File "/opt/conda/envs/coca/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
         ‚îÇ     ‚îî {'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': <_frozen_importlib_external.SourceFileLoader objec...
         ‚îî <code object <module> at 0x7f63e919f780, file "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/pyth...
  File "[32m/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/[1m__main__.py[39m[22m", line [33m39[39m, in [35m<module>
    [1mcli[35m.[39mmain()
    [36m‚îÇ   ‚îî [1m<function main at 0x7f63e7cc5050>
    [36m‚îî [1m<module 'debugpy.server.cli' from '/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/a...
  File "[32m/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/[1mcli.py[39m[22m", line [33m430[39m, in [35mmain
    [1mrun()
    [36m‚îî [1m<function run_file at 0x7f63e7cc3dd0>
  File "[32m/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/[1mcli.py[39m[22m", line [33m284[39m, in [35mrun_file
    [1mrunpy[35m.[39mrun_path(target,[22m [1mrun_name[35m=[36m[22m"__main__"[39m[1m)
    [36m‚îÇ     ‚îÇ        ‚îî [1m'/home/vqa_mplug/pretrain.py'
    [36m‚îÇ     ‚îî [1m<function run_path at 0x7f63e80dea70>
    [36m‚îî [1m<module '_pydevd_bundle.pydevd_runpy' from '/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/...
  File "[32m/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/[1mpydevd_runpy.py[39m[22m", line [33m322[39m, in [35mrun_path
    [1mpkg_name[35m=[39mpkg_name,[22m [1mscript_name[35m=[39mfname)
    [36m         ‚îÇ                     ‚îî [1m'/home/vqa_mplug/pretrain.py'
    [36m         ‚îî [1m''
  File "[32m/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/[1mpydevd_runpy.py[39m[22m", line [33m136[39m, in [35m_run_module_code
    [1mmod_name,[22m [1mmod_spec,[22m [1mpkg_name,[22m [1mscript_name)
    [36m‚îÇ         ‚îÇ         ‚îÇ         ‚îî [1m'/home/vqa_mplug/pretrain.py'
    [36m‚îÇ         ‚îÇ         ‚îî [1m''
    [36m‚îÇ         ‚îî [1mNone
    [36m‚îî [1m'__main__'
  File "[32m/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/[1mpydevd_runpy.py[39m[22m", line [33m124[39m, in [35m_run_code
    [1mexec(code,[22m [1mrun_globals)
    [36m     ‚îÇ     ‚îî [1m{'__name__': '__main__', '__doc__': None, '__package__': '', '__loader__': None, '__spec__': None, '__file__': '/home/vqa_mpl...
    [36m     ‚îî [1m<code object <module> at 0x7f63e6c81780, file "/home/vqa_mplug/pretrain.py", line 1>
> File "[32m/home/vqa_mplug/[1mpretrain.py[39m[22m", line [33m298[39m, in [35m<module>
    [1mmain(args,[22m [1mrun)
    [36m‚îÇ    ‚îÇ     ‚îî [1m<wandb.sdk.wandb_run.Run object at 0x7f62b7cdb1d0>
    [36m‚îÇ    ‚îî [1mNamespace(accum_iter=1, base_lr=0.0005, batch_size=16, checkpoint_path='', data_root='', dataset_names=['custom'], device='cu...
    [36m‚îî [1m<function main at 0x7f62b7d7ac20>
  File "[32m/home/vqa_mplug/[1mpretrain.py[39m[22m", line [33m155[39m, in [35mmain
    [1mmodel[22m [35m[1m=[39m[22m [1mMPlugForImageCaption(config[35m=[39mconfig)
    [36m        ‚îÇ                           ‚îî [1mMPlugConfig {
    [36m        ‚îÇ                             [1m  "add_object": false,
    [36m        ‚îÇ                             [1m  "add_ocr": false,
    [36m        ‚îÇ                             [1m  "alpha": 0.4,
    [36m        ‚îÇ                             [1m  "attention_probs_dropout_prob": 0.0,
    [36m        ‚îÇ                             [1m  "batch_size...
    [36m        ‚îî [1m<class 'model.modeling_mplug.MPlugForImageCaption'>
  File "[32m/home/vqa_mplug/model/[1mmodeling_mplug.py[39m[22m", line [33m2125[39m, in [35m__init__
    [1msuper()[35m.[39m__init__(config)
    [36m                 ‚îî [1mMPlugConfig {
    [36m                   [1m  "add_object": false,
    [36m                   [1m  "add_ocr": false,
    [36m                   [1m  "alpha": 0.4,
    [36m                   [1m  "attention_probs_dropout_prob": 0.0,
    [36m                   [1m  "batch_size...
  File "[32m/home/vqa_mplug/model/[1mmodeling_mplug.py[39m[22m", line [33m1838[39m, in [35m__init__
    [1mself[35m.[39mmodule_setting(config)
    [36m‚îÇ    ‚îÇ              ‚îî [1mMPlugConfig {
    [36m‚îÇ    ‚îÇ                [1m  "add_object": false,
    [36m‚îÇ    ‚îÇ                [1m  "add_ocr": false,
    [36m‚îÇ    ‚îÇ                [1m  "alpha": 0.4,
    [36m‚îÇ    ‚îÇ                [1m  "attention_probs_dropout_prob": 0.0,
    [36m‚îÇ    ‚îÇ                [1m  "batch_size...
    [36m‚îÇ    ‚îî [1m<function MPlug.module_setting at 0x7f62b7e00d40>
    [36m‚îî [1mMPlugForImageCaption()
  File "[32m/home/vqa_mplug/model/[1mmodeling_mplug.py[39m[22m", line [33m1950[39m, in [35mmodule_setting
    [1mself[35m.[39mconfig_encoder[35m.[39mnum_hidden_layers[22m [35m[1m=[39m[22m [1mself[35m.[39mconfig_encoder[35m.[39mtext_encoder_layers
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îÇ    ‚îî [1mBertConfig {
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îÇ      [1m  "architectures": [
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îÇ      [1m    "BertForMaskedLM"
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îÇ      [1m  ],
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îÇ      [1m  "attention_probs_dropout_prob": 0.1,
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îÇ      [1m  "classifier_dropout": n...
    [36m‚îÇ    ‚îÇ              ‚îÇ                   ‚îî [1mMPlugForImageCaption()
    [36m‚îÇ    ‚îÇ              ‚îî [1m12
    [36m‚îÇ    ‚îî [1mBertConfig {
    [36m‚îÇ      [1m  "architectures": [
    [36m‚îÇ      [1m    "BertForMaskedLM"
    [36m‚îÇ      [1m  ],
    [36m‚îÇ      [1m  "attention_probs_dropout_prob": 0.1,
    [36m‚îÇ      [1m  "classifier_dropout": n...
    [36m‚îî [1mMPlugForImageCaption()
  File "/opt/conda/envs/coca/lib/python3.7/site-packages/transformers/configuration_utils.py", line 260, in __getattribute__
    return super().__getattribute__(key)
                                    ‚îî 'text_encoder_layers'
[31m[1mAttributeError[39m[22m:[1m 'BertConfig' object has no attribute 'text_encoder_layers'
Traceback (most recent call last):
  File "/home/vqa_mplug/pretrain.py", line 298, in <module>
    main(args, run)
  File "/home/vqa_mplug/pretrain.py", line 155, in main
    model = MPlugForImageCaption(config=config)
  File "/home/vqa_mplug/model/modeling_mplug.py", line 2125, in __init__
    super().__init__(config)
  File "/home/vqa_mplug/model/modeling_mplug.py", line 1838, in __init__
    self.module_setting(config)
  File "/home/vqa_mplug/model/modeling_mplug.py", line 1950, in module_setting
    self.config_encoder.num_hidden_layers = self.config_encoder.text_encoder_layers
  File "/opt/conda/envs/coca/lib/python3.7/site-packages/transformers/configuration_utils.py", line 260, in __getattribute__
    return super().__getattribute__(key)
AttributeError: 'BertConfig' object has no attribute 'text_encoder_layers'
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/opt/conda/envs/coca/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/opt/conda/envs/coca/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/__main__.py", line 39, in <module>
    cli.main()
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 430, in main
    run()
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/adapter/../../debugpy/launcher/../../debugpy/../debugpy/server/cli.py", line 284, in run_file
    runpy.run_path(target, run_name="__main__")
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 322, in run_path
    pkg_name=pkg_name, script_name=fname)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 136, in _run_module_code
    mod_name, mod_spec, pkg_name, script_name)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_runpy.py", line 124, in _run_code
    exec(code, run_globals)
  File "/home/vqa_mplug/pretrain.py", line 302, in <module>
    exit(code=-1)
  File "/home/vqa_mplug/pretrain.py", line 302, in <module>
    exit(code=-1)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_frame.py", line 1197, in trace_dispatch
    self.do_wait_suspend(thread, frame, event, arg)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/_pydevd_bundle/pydevd_frame.py", line 165, in do_wait_suspend
    self._args[0].do_wait_suspend(*args, **kwargs)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/pydevd.py", line 2070, in do_wait_suspend
    keep_suspended = self._do_wait_suspend(thread, frame, event, arg, suspend_type, from_this_thread, frames_tracker)
  File "/root/.vscode-server/extensions/ms-python.python-2023.8.0/pythonFiles/lib/python/debugpy/_vendored/pydevd/pydevd.py", line 2106, in _do_wait_suspend
    time.sleep(0.01)
KeyboardInterrupt